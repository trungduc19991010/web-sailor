<!-- Dialog Header -->
<div class="flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-indigo-600 to-indigo-700">
  <div class="flex items-center gap-3">
    <mat-icon class="text-white text-3xl">lock_reset</mat-icon>
    <h2 class="text-2xl font-bold text-white m-0">Thay đổi mật khẩu</h2>
  </div>
  <button 
    mat-icon-button 
    (click)="onClose()" 
    class="text-white hover:bg-indigo-800 transition-colors"
    [disabled]="isSubmitting"
  >
    <mat-icon>close</mat-icon>
  </button>
</div>

<!-- Dialog Content -->
<div class="p-6">
  <!-- Security Notice -->
  <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded-r-lg">
    <div class="flex items-start gap-3">
      <mat-icon class="text-blue-600 mt-0.5">info</mat-icon>
      <div class="text-sm text-blue-800">
        <p class="font-semibold mb-1">Lưu ý bảo mật:</p>
        <ul class="list-disc list-inside space-y-1 text-xs">
          <li>Mật khẩu phải có ít nhất 6 ký tự</li>
          <li>Nên sử dụng kết hợp chữ hoa, chữ thường, số và ký tự đặc biệt</li>
          <li>Không chia sẻ mật khẩu với người khác</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Form -->
  <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()" class="space-y-5">
    <!-- Mật khẩu cũ -->
    <div class="form-group">
      <label class="block text-sm font-semibold text-gray-700 mb-2">
        <mat-icon class="align-middle text-indigo-600 mr-1" style="font-size: 18px; width: 18px; height: 18px;">lock_open</mat-icon>
        Mật khẩu cũ <span class="text-red-500">*</span>
      </label>
      <div class="relative">
        <input
          [type]="hideOldPassword ? 'password' : 'text'"
          formControlName="oldPassword"
          placeholder="Nhập mật khẩu hiện tại"
          autocomplete="current-password"
          class="w-full px-4 py-3 pr-12 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"
          [class.border-red-500]="hasError('oldPassword')"
          [class.border-gray-300]="!hasError('oldPassword')"
        />
        <button
          type="button"
          (click)="toggleOldPasswordVisibility()"
          class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
          tabindex="-1"
        >
          <mat-icon>{{ hideOldPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </div>
      <p *ngIf="hasError('oldPassword')" class="text-red-500 text-sm mt-1 flex items-center gap-1">
        <mat-icon class="text-base" style="font-size: 16px; width: 16px; height: 16px;">error</mat-icon>
        {{ getErrorMessage('oldPassword') }}
      </p>
    </div>

    <!-- Mật khẩu mới -->
    <div class="form-group">
      <label class="block text-sm font-semibold text-gray-700 mb-2">
        <mat-icon class="align-middle text-indigo-600 mr-1" style="font-size: 18px; width: 18px; height: 18px;">lock</mat-icon>
        Mật khẩu mới <span class="text-red-500">*</span>
      </label>
      <div class="relative">
        <input
          [type]="hideNewPassword ? 'password' : 'text'"
          formControlName="newPassword"
          placeholder="Nhập mật khẩu mới"
          autocomplete="new-password"
          class="w-full px-4 py-3 pr-12 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"
          [class.border-red-500]="hasError('newPassword')"
          [class.border-gray-300]="!hasError('newPassword')"
        />
        <button
          type="button"
          (click)="toggleNewPasswordVisibility()"
          class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
          tabindex="-1"
        >
          <mat-icon>{{ hideNewPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </div>
      <p *ngIf="hasError('newPassword')" class="text-red-500 text-sm mt-1 flex items-center gap-1">
        <mat-icon class="text-base" style="font-size: 16px; width: 16px; height: 16px;">error</mat-icon>
        {{ getErrorMessage('newPassword') }}
      </p>
    </div>

    <!-- Xác nhận mật khẩu mới -->
    <div class="form-group">
      <label class="block text-sm font-semibold text-gray-700 mb-2">
        <mat-icon class="align-middle text-indigo-600 mr-1" style="font-size: 18px; width: 18px; height: 18px;">verified_user</mat-icon>
        Xác nhận mật khẩu mới <span class="text-red-500">*</span>
      </label>
      <div class="relative">
        <input
          [type]="hideConfirmPassword ? 'password' : 'text'"
          formControlName="confirmPassword"
          placeholder="Nhập lại mật khẩu mới"
          autocomplete="new-password"
          class="w-full px-4 py-3 pr-12 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"
          [class.border-red-500]="hasError('confirmPassword')"
          [class.border-gray-300]="!hasError('confirmPassword')"
        />
        <button
          type="button"
          (click)="toggleConfirmPasswordVisibility()"
          class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors"
          tabindex="-1"
        >
          <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </div>
      <p *ngIf="hasError('confirmPassword')" class="text-red-500 text-sm mt-1 flex items-center gap-1">
        <mat-icon class="text-base" style="font-size: 16px; width: 16px; height: 16px;">error</mat-icon>
        {{ getErrorMessage('confirmPassword') }}
      </p>
    </div>

    <!-- Action Buttons -->
    <div class="flex gap-3 pt-4">
      <button
        type="submit"
        mat-raised-button
        color="primary"
        [disabled]="isSubmitting || changePasswordForm.invalid"
        class="flex-1 py-3 px-6 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-2"
      >
        <mat-spinner *ngIf="isSubmitting" diameter="20" class="inline-block"></mat-spinner>
        <mat-icon *ngIf="!isSubmitting">lock_reset</mat-icon>
        <span *ngIf="!isSubmitting">Đổi mật khẩu</span>
        <span *ngIf="isSubmitting">Đang xử lý...</span>
      </button>

      <button
        type="button"
        mat-button
        (click)="onClose()"
        [disabled]="isSubmitting"
        class="px-6 py-3 bg-gray-100 text-gray-700 font-semibold rounded-lg hover:bg-gray-200 disabled:bg-gray-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2"
      >
        <mat-icon>close</mat-icon>
        <span>Hủy</span>
      </button>
    </div>
  </form>
</div>
